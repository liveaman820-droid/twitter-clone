{% extends "base.html" %}

{% block title %}{{ profile_user.display_name }} (@{{ profile_user.username }}) / Twitter Clone{% endblock %}

{% block content %}
<!-- Header -->
<header class="header">
    <div class="header-container">
        <div class="logo">
            <i class="fab fa-twitter"></i>
            <span>Twitter</span>
        </div>
        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search Twitter" id="searchInput">
            </div>
        </div>
        <div class="header-right">
            <button class="theme-toggle" id="themeToggle" title="Toggle dark mode">
                <i class="fas fa-moon"></i>
            </button>
            <div class="profile-menu" id="profileMenu">
                <img src="" alt="Profile" class="profile-img" id="currentUserImg">
                <span id="currentUserName">Loading...</span>
                <i class="fas fa-chevron-down"></i>
                <div class="dropdown-menu" id="dropdownMenu">
                    <a href="/home"><i class="fas fa-home"></i> Home</a>
                    <a href="#" id="profileLink"><i class="fas fa-user"></i> My Profile</a>
                    <a href="#" id="logoutLink"><i class="fas fa-sign-out-alt"></i> Logout</a>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Main Container -->
<div class="main-container">
    <!-- Left Sidebar -->
    <aside class="sidebar-left">
        <nav class="nav-menu">
            <div class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </div>
            <div class="nav-item" data-page="explore">
                <i class="fas fa-hashtag"></i>
                <span>Explore</span>
            </div>
            <div class="nav-item" data-page="notifications">
                <i class="fas fa-bell"></i>
                <span>Notifications</span>
                <span class="notification-count" id="notificationCount" style="display: none;"></span>
            </div>
            <div class="nav-item" data-page="messages">
                <i class="fas fa-envelope"></i>
                <span>Messages</span>
            </div>
            <div class="nav-item" data-page="bookmarks">
                <i class="fas fa-bookmark"></i>
                <span>Bookmarks</span>
            </div>
            <div class="nav-item active" data-page="profile">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Profile Header -->
        <div class="profile-header-nav">
            <button class="back-btn" onclick="history.back()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="profile-header-info">
                <h2 id="profileDisplayName">{{ profile_user.display_name }}</h2>
                <span id="profileTweetsCount">{{ profile_user.get_tweets_count() }} Tweets</span>
            </div>
        </div>

        <!-- Profile Section -->
        <div class="profile-section">
            <div class="profile-header">
                <div class="profile-cover"></div>
                <div class="profile-info">
                    <img src="{{ profile_user.avatar }}" alt="Profile" class="profile-avatar" id="profileAvatar">
                    <div class="profile-details">
                        <div class="profile-name-section">
                            <h2 id="profileDisplayNameMain">{{ profile_user.display_name }}</h2>
                            {% if profile_user.verified %}
                            <i class="fas fa-check-circle verified-badge"></i>
                            {% endif %}
                        </div>
                        <p class="profile-username" id="profileUsername">@{{ profile_user.username }}</p>
                        <p class="profile-bio" id="profileBio">{{ profile_user.bio }}</p>
                        <div class="profile-meta">
                            {% if profile_user.location %}
                            <span><i class="fas fa-map-marker-alt"></i> {{ profile_user.location }}</span>
                            {% endif %}
                            {% if profile_user.website %}
                            <span><i class="fas fa-link"></i> <a href="{{ profile_user.website }}" target="_blank">{{ profile_user.website }}</a></span>
                            {% endif %}
                            <span><i class="fas fa-calendar"></i> Joined {{ profile_user.created_at.strftime('%B %Y') }}</span>
                        </div>
                        <div class="profile-stats">
                            <span><strong id="profileFollowing">{{ profile_user.get_following_count() }}</strong> Following</span>
                            <span><strong id="profileFollowers">{{ profile_user.get_followers_count() }}</strong> Followers</span>
                        </div>
                    </div>
                    <button class="follow-profile-btn" id="followProfileBtn" data-user-id="{{ profile_user.id }}">
                        Follow
                    </button>
                </div>
            </div>
            
            <div class="profile-tabs">
                <button class="tab-btn active" data-tab="tweets">Tweets</button>
                <button class="tab-btn" data-tab="replies">Tweets & replies</button>
                <button class="tab-btn" data-tab="media">Media</button>
                <button class="tab-btn" data-tab="likes">Likes</button>
            </div>
            
            <div class="profile-content" id="profileContent">
                <div class="loading" id="loadingIndicator">
                    <i class="fas fa-spinner fa-spin"></i> Loading tweets...
                </div>
            </div>
        </div>
    </main>

    <!-- Right Sidebar -->
    <aside class="sidebar-right">
        <!-- Trending -->
        <div class="widget trending-widget">
            <h3>What's happening</h3>
            <div id="trendingContent">
                <div class="loading">Loading trends...</div>
            </div>
        </div>

        <!-- Footer -->
        <div class="widget footer-widget">
            <div class="footer-links">
                <a href="#">Terms of Service</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Cookie Policy</a>
            </div>
            <p>&copy; 2024 Twitter Clone</p>
        </div>
    </aside>
</div>

<!-- Mobile Bottom Navigation -->
<div class="mobile-nav">
    <div class="mobile-nav-item" data-page="home">
        <i class="fas fa-home"></i>
    </div>
    <div class="mobile-nav-item" data-page="explore">
        <i class="fas fa-hashtag"></i>
    </div>
    <div class="mobile-nav-item" data-page="notifications">
        <i class="fas fa-bell"></i>
    </div>
    <div class="mobile-nav-item" data-page="messages">
        <i class="fas fa-envelope"></i>
    </div>
</div>

<!-- Hidden data for JavaScript -->
<script>
    window.profileData = {
        username: "{{ profile_user.username }}",
        userId: {{ profile_user.id }}
    };
</script>

<!-- Notifications -->
<div id="notification" class="notification"></div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/profile.js') }}"></script>
{% endblock %}